
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://qdemouliere.github.io/cub/documentation/Stormshield/fiche06_configurationNat_SNS/">
      
      
        <link rel="prev" href="../fiche05_configurationObjetsReseaux_SNS/">
      
      
        <link rel="next" href="../fiche07_filtrage_protocolaire_SNS/">
      
      
      <link rel="icon" href="../../../media/cub/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Fiche 06 -- Configuration du NAT/PAT - Le contexte CUB</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#fiche-06-configuration-du-natpat" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href="../../.." title="Le contexte CUB" class="md-header__button md-logo" aria-label="Le contexte CUB" data-md-component="logo">
      
  <img src="../../../media/cub/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Le contexte CUB
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Fiche 06 -- Configuration du NAT/PAT
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Le contexte CUB" class="md-nav__button md-logo" aria-label="Le contexte CUB" data-md-component="logo">
      
  <img src="../../../media/cub/logo.png" alt="logo">

    </a>
    Le contexte CUB
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Contexte
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Contexte
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contexte/01-presentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Présentation du contexte CUB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contexte/02-schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schémas réseaux de l'entreprise CUB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contexte/03-infra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Description de l'infrastructure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contexte/bonnespratiques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Référentiel défini par la DSI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    DNS
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            DNS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS/1--Pr%C3%A9ambule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS/2--Resolver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Serveur DNS récursif
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS/3--Autority/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Serveur DNS maître faisant autorité
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS/4--Slave/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Serveur DNS esclave faisant autorité
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS/5--Delegation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Délégation de zone
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS/6--Resolutioninverse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    La résolution inverse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS/7--Tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tests et diagnostics DNS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/2--OTP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Authentification TOTP sur Debian
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Stormshield
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Stormshield
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commandesUtilesConsole_SNS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheatSheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fiche01_initialiser_SNS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fiche 01 -- Initialiser un Pare-feu SNS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fiche02_priseEnMain_SNS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fiche 02 -- Prise en main d'un Pare-feu SNS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fiche03_gestionJournaux_SNS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fiche 03 -- Traces, Journaux et supervision
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fiche04_configurationReseau_SNS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fiche 04 -- Configuration du réseau
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fiche05_configurationObjetsReseaux_SNS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fiche 05 -- Configuration des Objets Réseau
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Fiche 06 -- Configuration du NAT/PAT
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Fiche 06 -- Configuration du NAT/PAT
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mise-en-uvre-du-nat-dynamique" class="md-nav__link">
    <span class="md-ellipsis">
      Mise en œuvre du NAT dynamique
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mise-en-uvre-du-nat-statique-par-port-redirection-de-port" class="md-nav__link">
    <span class="md-ellipsis">
      Mise en œuvre du NAT statique par port (redirection de port)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fiche07_filtrage_protocolaire_SNS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fiche 07-- Filtrage protocolaire
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fiche08_filtrage_applicatifSNS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fiche 08 -- Filtrage applicatif
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fiche09_IDS_IPS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fiche 09 -- Prévention d'intrusion IDS/IPS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fiche10_utilisateurs_authentification_SNS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fiche 10 -- Utilisateurs, authentification et portail captif
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fiche11_infrastructure_cles_publiques_SNS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fiche 11 -- Infrastructures à clés pubiques (PKI)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fiche12_vpn_openvpn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fiche 12 -- VPN pour utilisateurs nomades
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fiche13_vpn_ipsec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fiche 13 -- VPN site à site
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Versioning
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Versioning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Versioning/2--Etckeeper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gestion des versions de /etc avec Etckeeper
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mise-en-uvre-du-nat-dynamique" class="md-nav__link">
    <span class="md-ellipsis">
      Mise en œuvre du NAT dynamique
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mise-en-uvre-du-nat-statique-par-port-redirection-de-port" class="md-nav__link">
    <span class="md-ellipsis">
      Mise en œuvre du NAT statique par port (redirection de port)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="fiche-06-configuration-du-natpat">Fiche 06 -- Configuration du NAT/PAT</h1>
<p>Dans les pare-feu SNS, les règles de filtrage et NAT
(traduction d'adresses) sont regroupées sous une même politique. Il est
possible de définir 10 politiques différentes mais une seule politique
est active à la fois, identifiée par l'icône <img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/10000001000000190000001611338230E4300D82.png" /> :</p>
<h2 id="mise-en-uvre-du-nat-dynamique">Mise en œuvre du NAT dynamique</h2>
<div class="admonition success">
<p class="admonition-title">NAT dynamique</p>
<p><strong>La règle de NAT dynamique NAPT permet aux machines du réseau interne
(Network_internals) d'accéder au réseau externe (Network_Out) et à
Internet</strong></p>
</div>
<p>La règle de <strong>NAT dynamique</strong> est créée avec le bouton <strong>Nouvelle
règle</strong> / <strong>règle de partage d'adresse source (masquerading)</strong> qui
ajoute automatiquement la plage de ports
prédéfinie <strong>ephemeral_fw</strong> [20000-59999] au niveau du port source
dans le trafic après traduction. Par défaut, les ports sont choisis
séquentiellement dans cette plage, cependant une option est disponible
pour permettre un choix aléatoire du numéro de port pour chaque nouvelle
connexion et le rendre ainsi moins prédictible.</p>
<ul>
<li>Dans votre politique <strong>(10)</strong>, sélectionner l'onglet NAT puis
    <strong>Nouvelle règle</strong> / <strong>règle de partage d'adresse source
    (masquerading)</strong> </li>
</ul>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/100000010000025D0000005D37DB1C8FCAFB5DB3.png" /></p>
<p>Une nouvelle règle non activée apparaît avec des valeurs par défaut any,
any. Dans la section <strong>Trafic après translation</strong>, le port source sera
traduit par un numéro de port choisi dans la plage <strong>ephemeral_fw</strong>.</p>
<p>La configuration du <strong>Trafic original (avant translation)</strong> permet de
renseigner les valeurs des paramètres avant traduction (par défaut any,
any) :</p>
<ul>
<li><strong>Source </strong>permet de définir l'adresse IP d'un hôte ou du réseau
    source ;</li>
<li><strong>Destination </strong>permet de définir l'adresse IP d'un hôte ou du
    réseau destination.</li>
</ul>
<p>La configuration du <strong>Trafic après translation</strong> permet de renseigner
les nouvelles valeurs des paramètres après traduction (par défaut any,
any) :</p>
<ul>
<li><strong>Source</strong> définit l'adresse IP ou le réseau source et le <strong>port</strong>
    source vus de l'extérieur.</li>
<li><strong>Destination</strong> définit l'adresse IP ou le réseau destination et
    <strong>Port destination</strong> translatée le port de destination.</li>
</ul>
<p>Pour configurer un NAT/PAT pour permettre la sortie sur Internet</p>
<ul>
<li>Double-cliquer sur une zone vide de la règle pour ouvrir la fenêtre
    de configuration détaillée « <strong>Edition de la règle N°1 </strong>».</li>
<li>Cliquer l'onglet du menu de gauche <strong>Général</strong>, dans la
    zone <strong>Commentaire,</strong> saisir un commentaire, par exemple
    « Configuration de la règle de NAT/PAT pour la sortie internet ».</li>
<li>Cliquer sur l'onglet du menu de gauche <strong>Source Originale.</strong></li>
<li>Double-cliquer sur Any et avec la flèche choisir
    <strong>Network_internals</strong> (qui renvoie à tous les réseaux internes
    protégés), dans l'onglet Configuration avancée, laissez <strong>Any</strong> pour
    le port de destination.</li>
</ul>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/100000010000025C000000C98CB41F68EC1A4782.png" /></p>
<ul>
<li>Cliquer sur l'onglet du menu de gauche <strong>Destination originale.</strong></li>
<li>Double-cliquer sur <strong>Any</strong> et avec la flèche choisir <strong>Internet</strong>,
    laissez <strong>Any </strong>pour le port de destination.</li>
</ul>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/10000001000001E3000000E1B6F7047F81623EC0.png" /></p>
<div class="admonition warning">
<p class="admonition-title">Attention</p>
<p><strong>Attention</strong> : si dans la zone <strong>destination
originale</strong>, vous laissez <strong>Any</strong>, plutôt qu'<strong>Internet</strong> qui désigne
tous les réseaux sauf ceux internes au pare-feu SNS, le pare-feu SNS
bloquera les flux d'administration (en ssh et en https). En effet, les
flux d'administration subiront également une traduction NAT vers
l'interface <strong>OUT</strong> qui l'interprétera comme une tentative d'intrusion
et les bloquera.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Solution</p>
<p>Vous pouvez rendre cette règle plus restrictive en choisissant
explicitement l'interface de sortie.</p>
</div>
<ul>
<li>Cliquer sur l'onglet <strong>Configuration avancée</strong> et sélectionnez
    <strong>out</strong> dans <strong>Interface de sortie</strong>.</li>
</ul>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/10000001000001E20000009A05AB94690DDD9521.png" /></p>
<ul>
<li>Cliquer sur l'onglet <strong>Source translatée</strong> et
    sélectionner <strong>Firewall_Out </strong>dans <strong>Machine source translatée</strong>.</li>
<li>Dans <strong>Port source translaté</strong>, laisser <strong>ephemeral_fw </strong>et cocher
    <strong>choisir aléatoirement le port source translaté</strong>.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Information importante</p>
<p>Cette option <strong>choisit aléatoirement le port source
translaté</strong>, ce qui permet d'éviter les attaques utilisant la
prédictibilité des ports utilisés. Ainsi si le premier port est 10000,
le suivant ne sera pas 10001. Cette précaution n'empêche pas les
attaques, elle permet de les rendre plus complexes.</p>
</div>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/1000000100000282000000E4263B6D14E5D74200.png" /></p>
<ul>
<li>Cliquer l'onglet du menu de gauche <strong>Protocole</strong>, cela permet de
    définir le type de protocole : applicatif, IP ou Ethernet, laisser
    <strong>Détection automatique du protocole (par défaut)</strong></li>
</ul>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/1000000100000282000000D9D67F857B0B841622.png" /></p>
<ul>
<li>Cliquer sur l'onglet du menu de gauche <strong>Options</strong>, cela permet de
    tracer le trafic qui correspond à la règle de traduction dans le
    journal de connexions, choisir <strong>tracer</strong>.</li>
</ul>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/1000000100000282000000C64CD2B9D6CBB11E3E.png" /></p>
<div class="admonition info">
<p class="admonition-title">Nota Bene</p>
<p>NB : Le NAT ne laisse jamais de traces dans le journal de connexions.
Pour tracer une règle de NAT, il faut choisir l'option « tracer »,
sinon, aucune journalisation de NAT ne sera effectuée.</p>
</div>
<ul>
<li><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/10000001000000980000003EB64457464695E7CE.png" /></li>
<li>Cliquer sur <strong>OK</strong> pour sauvegarder les
    modifications de la règle de NAT dynamique que vous venez de créer.</li>
<li>
<p>Dans la colonne <strong>État</strong>, sélectionner avec la flèche <strong>Définir
    l'état on</strong> <img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/100000010000003200000017E469BC9134DE71E7.png" /></p>
</li>
<li>
<p>Cliquer sur <strong>Appliquer</strong> puis <strong>Oui, Activer</strong> <strong>la politique</strong>
    puis confirmer.</p>
</li>
</ul>
<p>Dans la liste des règles la barre devient verte quand les règles
s'appliquent et une info-bulle indique le nombre de fois où la règle a
été appliquée :</p>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/1000000100000285000000739E0225667E887616.png" /></p>
<ul>
<li>Dans le bandeau d'affichage des règles, déplier le menu
    <img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/100000010000001500000012C004A96468C7D42F.png" /> et cliquer sur <strong>Réinitialiser les statistiques
    des règles </strong>pour remettre les compteurs à zéro.</li>
</ul>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/100000010000019F0000006895FA7BF1553E2276.png" /></p>
<h2 id="mise-en-uvre-du-nat-statique-par-port-redirection-de-port">Mise en œuvre du NAT statique par port (redirection de port)</h2>
<p><strong>Pour faire une redirection NAT « classique »</strong>, il faut sélectionner
l'onglet <strong>NAT</strong> puis <strong>Nouvelle règle / règle simple.</strong></p>
<p><strong>Exemple </strong>avec une règle de NAT afin qu'unserveur WEB (objet
srv_web_priv, protocole http) soit joignable grâce à une redirection de
port via l'adresse IP publique OUT d'un pare-feu: « 192.36.253.70 ».</p>
<ul>
<li>
<p>Source originale = <strong>Internet</strong>, Interface d'entrée = <strong>out</strong></p>
</li>
<li>
<p>Destination originale = <strong>Firewall_Out</strong>, Port dest= <strong>http</strong></p>
</li>
<li>
<p>Source translatée = <strong>Any (</strong>ou pas de source<strong>)</strong></p>
</li>
<li>
<p>Destination translatée = <strong>srv_web_priv</strong>, Port destination translaté = <strong>none</strong></p>
</li>
</ul>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/100000010000028500000020CE7DCECAD160DE6E.png" /></p>
<ul>
<li>Cliquer <strong>Appliquer</strong> puis <strong>Oui, Activer</strong> <strong>la politique</strong> puis
    confirmer.</li>
</ul>
<p>Le détail ci-dessous :</p>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/100000010000063A0000047E26B39C209173F957.png" /></p>
<ul>
<li>Dans l'onglet <strong>Destination</strong> de la règle de filtrage, choisissez
    l'onglet <strong>Configuration avancée</strong>, puis dans <strong>NAT sur la
    destination</strong>, sélectionner l'objet correspondant à votre serveur
    web privé :</li>
</ul>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/10000001000002470000007308615CCF64D2ACCA.png" /></p>
<ul>
<li>Puis dans l'onglet Port/Protocole, choisir http dans la zone Port destination translaté.</li>
</ul>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/100000010000024300000067CEB56635AAFA97A3.png" /></p>
<p>Traçage des règles de NAT</p>
<p>Activer le traçage des règles de NAT permet d'avoir les informations
visibles dans les Journaux d'audit (logs).</p>
<ul>
<li>Double-cliquer sur la règle que vous voulez tracer et choisissez
    l'onglet <strong>Options</strong>, et dans niveau de trace <strong>tracer </strong>puis **OK.
    **</li>
</ul>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/100000010000025F000000A6E26374D297FEA18A.png" />
Vous pouvez tester l'accès à l'ensemble de vos ressources et vérifier le
traçage des règles demandées dans les logs du pare-feu (journal
<strong>standard</strong> et journal <strong>Filtrage</strong>).</p>
<ul>
<li>Cliquer sur l'onglet <strong>Monitoring </strong>puis <strong>LOGS - Journaux d'audit /
    Vues / Trafic réseau</strong> : vous devriez voir apparaître les traces :</li>
</ul>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/1000000100000285000001535A167F9630CF1844.png" /></p>
<div class="admonition info">
<p class="admonition-title">Information importante</p>
<p>Il est également possible de réaliser une redirection de ports
directement lors de la création d'une règle de filtrage (voir fiche 6).
L'intérêt d'intégrer le filtrage et la redirection dans une règle unique
est d'optimiser les performances puisque le pare-feu réalise un seul
traitement au lieu de deux. Voici un exemple ci-dessous équivalent à la
règle précédente :</p>
</div>
<p><img alt="" src="../../../media/stormshield/fiches/fiche6_configurationNat_SNS/Pictures/100000010000023800000024281AE3C8E6093FEA.png" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Pied de page" >
        
          
          <a href="../fiche05_configurationObjetsReseaux_SNS/" class="md-footer__link md-footer__link--prev" aria-label="Précédent: Fiche 05 -- Configuration des Objets Réseau">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Précédent
              </span>
              <div class="md-ellipsis">
                Fiche 05 -- Configuration des Objets Réseau
              </div>
            </div>
          </a>
        
        
          
          <a href="../fiche07_filtrage_protocolaire_SNS/" class="md-footer__link md-footer__link--next" aria-label="Suivant: Fiche 07-- Filtrage protocolaire">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Suivant
              </span>
              <div class="md-ellipsis">
                Fiche 07-- Filtrage protocolaire
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Licence CC 4.0 FR BY-NC-SA - 2025 D. Balny et Q. Demoulière - Lycée Paul-Louis Courier
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.footer", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>